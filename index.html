<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>replit</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
</head>

<body>
  <script src="script.js"></script>
  <script src="https://replit.com/pblic/js/replit-badge.js" theme="teal" defer></script>
  <canvas id="myCanvas" onmousedown="draw(event)" width="400" height="400"></canvas>
  <script>
    const radius = 40;
    const nodes = [];
    var entity = "node";//take off if need be
    const linePoints = [];
    
    function draw(event) {
      var canvas = document.getElementById("myCanvas");
      var ctx = canvas.getContext("2d");
      console.log(true);
      
      if (entity == "node") {
        if (nodes.every(isTouching)){
          ctx.beginPath();
          ctx.arc(event.clientX, event.clientY, radius, 0, 2 * Math.PI);
          ctx.stroke();
          nodes.push({x: event.clientX, y: event.clientY}); 
        }
      }

      else if (entity == "weight") {
        if (linePoints.length == 0) {
          linePoints.push(event.clientX, event.clientY);
        }
        else if (linePoints.length == 2) {
          ctx.moveTo(linePoints[0], linePoints[1]);
          ctx.lineTo(event.clientX, event.clientY);
          ctx.stroke();
          linePoints.pop();
          linePoints.pop();
        }
      }
    }

    function onCircle(el, index, arr) {
      return Math.sqrt(Math.pow(el.x - event.clientX, 2) + Math.pow(el.y - event.clientY, 2)) <= radius;
    }

    function isTouching(el, index, arr) {
      return Math.sqrt(Math.pow(el.x - event.clientX, 2) + Math.pow(el.y - event.clientY, 2)) > 2 * radius;
    }

    function updateEntity() {
      if (entity == "node") {
        entity = "weight";
      }

      else {
        entity = "node";
      }

      document.getElementById("entity-switch").innerHTML = entity;
    }
  </script>
  <button id="entity-switch" onclick="updateEntity()"></button>
</body>

</html>